from flask import Flask, jsonify
import asyncio
import aiohttp
import time
from datetime import datetime, timezone, timedelta
import os

app = Flask(__name__)


group_accounts = [
    {
        "4182940828": "C4_RIZAKYI_BNGX_VIP_DMRBC7MS",
        "4182940823": "C4_RIZAKYI_BNGX_VIP_K34JKBYB",
        "4182940830": "C4_RIZAKYI_BNGX_VIP_DBFRALNM",
        "4182940837": "C4_RIZAKYI_BNGX_VIP_CMDFFYLB",
        "4182940841": "C4_RIZAKYI_BNGX_VIP_4KFHBOXF",
        "4182940835": "C4_RIZAKYI_BNGX_VIP_H7JDOQ8G",
        "4182940827": "C4_RIZAKYI_BNGX_VIP_KTUHWQBQ",
        "4182940825": "C4_RIZAKYI_BNGX_VIP_S0YSEBPX",
        "4182940843": "C4_RIZAKYI_BNGX_VIP_ZCZ53KDX",
        "4182940836": "C4_RIZAKYI_BNGX_VIP_ASK542PD",
        "4182940842": "C4_RIZAKYI_BNGX_VIP_EKQGFRUI",
        "4182940831": "C4_RIZAKYI_BNGX_VIP_JSVSLT3B",
        "4182940826": "C4_RIZAKYI_BNGX_VIP_SJL744AW",
        "4182940824": "C4_RIZAKYI_BNGX_VIP_KQJ3049C",
        "4182940840": "C4_RIZAKYI_BNGX_VIP_JOERBM3M",
        "4182940832": "C4_RIZAKYI_BNGX_VIP_NHAHXFRX",
        "4182940822": "C4_RIZAKYI_BNGX_VIP_KS6YLG56",
        "4182940833": "C4_RIZAKYI_BNGX_VIP_VVOADP3J",
        "4182940834": "C4_RIZAKYI_BNGX_VIP_64C5JAXT",
        "4182940829": "C4_RIZAKYI_BNGX_VIP_US2MGPBH",
        "4182943566": "C4_RIZAKYI_BNGX_VIP_YFVQMDJS",
        "4182943556": "C4_RIZAKYI_BNGX_VIP_ICXYL53U",
        "4182943559": "C4_RIZAKYI_BNGX_VIP_TMBYYXWA",
        "4182943562": "C4_RIZAKYI_BNGX_VIP_VDZXJUR8",
        "4182943571": "C4_RIZAKYI_BNGX_VIP_AD1JJGIO",
        "4182943572": "C4_RIZAKYI_BNGX_VIP_MNCO1SLZ",
        "4182943574": "C4_RIZAKYI_BNGX_VIP_GBFM4OWM",
        "4182943568": "C4_RIZAKYI_BNGX_VIP_TGHEPCML",
        "4182943557": "C4_RIZAKYI_BNGX_VIP_BKDGPICB",
        "4182943569": "C4_RIZAKYI_BNGX_VIP_6LO1RUBE",
        "4182943560": "C4_RIZAKYI_BNGX_VIP_MNPBLPQR",
        "4182943570": "C4_RIZAKYI_BNGX_VIP_3WR2J98L",
        "4182943561": "C4_RIZAKYI_BNGX_VIP_GG5XBRPF",
        "4182943573": "C4_RIZAKYI_BNGX_VIP_IXBIYQSK",
        "4182943555": "C4_RIZAKYI_BNGX_VIP_VYLMV9XN",
        "4182943563": "C4_RIZAKYI_BNGX_VIP_ELWLZ7GI",
        "4182943564": "C4_RIZAKYI_BNGX_VIP_TVQJ2HBB",
        "4182943565": "C4_RIZAKYI_BNGX_VIP_QEV6KMQY",
        "4182943558": "C4_RIZAKYI_BNGX_VIP_BR6HUVB7",
        "4182943567": "C4_RIZAKYI_BNGX_VIP_UKQYI2XB",
        "4182944867": "C4_RIZAKYI_BNGX_VIP_SEKMB6TW",
        "4182944869": "C4_RIZAKYI_BNGX_VIP_AG1OYXDL",
        "4182944868": "C4_RIZAKYI_BNGX_VIP_6TZH99QI",
        "4182944871": "C4_RIZAKYI_BNGX_VIP_H3F0VGAN",
        "4182944866": "C4_RIZAKYI_BNGX_VIP_H43THCGH",
        "4182944877": "C4_RIZAKYI_BNGX_VIP_HWARQTT6",
        "4182944874": "C4_RIZAKYI_BNGX_VIP_PB0VVZTM",
        "4182944880": "C4_RIZAKYI_BNGX_VIP_WC0NHWIC",
        "4182944878": "C4_RIZAKYI_BNGX_VIP_9JL17I9X",
        "4182944873": "C4_RIZAKYI_BNGX_VIP_PFGN4AOJ",
        "4182944875": "C4_RIZAKYI_BNGX_VIP_4TEJS0VG",
        "4182944872": "C4_RIZAKYI_BNGX_VIP_IDIRH2SN",
        "4182944883": "C4_RIZAKYI_BNGX_VIP_STIFACIR",
        "4182944884": "C4_RIZAKYI_BNGX_VIP_FA49BYCW",
        "4182944876": "C4_RIZAKYI_BNGX_VIP_UNW639LI",
        "4182944882": "C4_RIZAKYI_BNGX_VIP_GGWCZVXX",
        "4182944870": "C4_RIZAKYI_BNGX_VIP_RFVVDNRD",
        "4182944879": "C4_RIZAKYI_BNGX_VIP_QIN83IGW",
        "4182944881": "C4_RIZAKYI_BNGX_VIP_ATCLV3XX",
        "4182944885": "C4_RIZAKYI_BNGX_VIP_Z49H7L6P",
        "4182948046": "C4_RIZAKYI_BNGX_VIP_S3AQ4GRC",
        "4182948060": "C4_RIZAKYI_BNGX_VIP_L0IHXYVY",
        "4182948049": "C4_RIZAKYI_BNGX_VIP_OUNM5WJI",
        "4182948058": "C4_RIZAKYI_BNGX_VIP_2OGLKV80",
        "4182948052": "C4_RIZAKYI_BNGX_VIP_U07DPSTE",
        "4182948047": "C4_RIZAKYI_BNGX_VIP_KVTEUBNU",
        "4182948053": "C4_RIZAKYI_BNGX_VIP_TPTYWSZR",
        "4182948055": "C4_RIZAKYI_BNGX_VIP_W3Y8AKM8",
        "4182948062": "C4_RIZAKYI_BNGX_VIP_YG6SJDR5",
        "4182948050": "C4_RIZAKYI_BNGX_VIP_RFCZSJEL",
        "4182948045": "C4_RIZAKYI_BNGX_VIP_H8PTT1QL",
        "4182948057": "C4_RIZAKYI_BNGX_VIP_J35UDGBC",
        "4182948044": "C4_RIZAKYI_BNGX_VIP_C5R8EYZ5",
        "4182948043": "C4_RIZAKYI_BNGX_VIP_ELERPSHJ",
        "4182948056": "C4_RIZAKYI_BNGX_VIP_JUKFZNZS",
        "4182948054": "C4_RIZAKYI_BNGX_VIP_24FOYXXB",
        "4182948048": "C4_RIZAKYI_BNGX_VIP_WDLG8B7D",
        "4182948051": "C4_RIZAKYI_BNGX_VIP_8RVSBKQ1",
        "4182948059": "C4_RIZAKYI_BNGX_VIP_44UIOWJC",
        "4182948061": "C4_RIZAKYI_BNGX_VIP_PW7YJDEN",
        "4182949547": "C4_RIZAKYI_BNGX_VIP_MSUV6GT3",
        "4182949550": "C4_RIZAKYI_BNGX_VIP_MW2LXFWV",
        "4182949566": "C4_RIZAKYI_BNGX_VIP_OTX3KMMK",
        "4182949561": "C4_RIZAKYI_BNGX_VIP_PJ1RX789",
        "4182949551": "C4_RIZAKYI_BNGX_VIP_FGHRXGN7",
        "4182949555": "C4_RIZAKYI_BNGX_VIP_VHQ7GOLJ",
        "4182949570": "C4_RIZAKYI_BNGX_VIP_W5ILWOWB",
        "4182949557": "C4_RIZAKYI_BNGX_VIP_N0AFU4VV",
        "4182949560": "C4_RIZAKYI_BNGX_VIP_ZLYQKKFN",
        "4182949569": "C4_RIZAKYI_BNGX_VIP_1RQXUFHQ",
        "4182949563": "C4_RIZAKYI_BNGX_VIP_7BG6P51Y",
        "4182949567": "C4_RIZAKYI_BNGX_VIP_VIADTC6L",
        "4182949553": "C4_RIZAKYI_BNGX_VIP_PLH3HNFQ",
        "4182949562": "C4_RIZAKYI_BNGX_VIP_3PBD61OX",
        "4182949564": "C4_RIZAKYI_BNGX_VIP_844GVVM3",
        "4182949565": "C4_RIZAKYI_BNGX_VIP_71BYTPA0",
        "4182949559": "C4_RIZAKYI_BNGX_VIP_SOUGPDEY",
        "4182949568": "C4_RIZAKYI_BNGX_VIP_ABWNQ9QO",
        "4182949554": "C4_RIZAKYI_BNGX_VIP_EYGPUEFZ",
        "4182951836": "C4_RIZAKYI_BNGX_VIP_SUFNTDQN"
    },
    {
        "4182951854": "C4_RIZAKYI_BNGX_VIP_XFKDKRUN",
        "4182951850": "C4_RIZAKYI_BNGX_VIP_HTJQXGCJ",
        "4182951842": "C4_RIZAKYI_BNGX_VIP_LNHIU87L",
        "4182951848": "C4_RIZAKYI_BNGX_VIP_PKYOVEYT",
        "4182951841": "C4_RIZAKYI_BNGX_VIP_FN6GQES0",
        "4182951852": "C4_RIZAKYI_BNGX_VIP_X0YBWEBC",
        "4182951839": "C4_RIZAKYI_BNGX_VIP_TTCH0SZX",
        "4182951838": "C4_RIZAKYI_BNGX_VIP_G4FYGMJS",
        "4182951844": "C4_RIZAKYI_BNGX_VIP_BEFWRERQ",
        "4182951853": "C4_RIZAKYI_BNGX_VIP_4SXAI8FZ",
        "4182951847": "C4_RIZAKYI_BNGX_VIP_T7TOQQHK",
        "4182951845": "C4_RIZAKYI_BNGX_VIP_TEOTN1DC",
        "4182951846": "C4_RIZAKYI_BNGX_VIP_O5IHPIEM",
        "4182951851": "C4_RIZAKYI_BNGX_VIP_J0TGRZUF",
        "4182951835": "C4_RIZAKYI_BNGX_VIP_OADQPJLL",
        "4182951840": "C4_RIZAKYI_BNGX_VIP_EV99VJWI",
        "4182951837": "C4_RIZAKYI_BNGX_VIP_TU0HXHWT",
        "4182951849": "C4_RIZAKYI_BNGX_VIP_BZSSX4UU",
        "4182951843": "C4_RIZAKYI_BNGX_VIP_UTMFOU4M",
        "4182952568": "C4_RIZAKYI_BNGX_VIP_7AOX37PL",
        "4182952580": "C4_RIZAKYI_BNGX_VIP_NQWDO25J",
        "4182952567": "C4_RIZAKYI_BNGX_VIP_TSJ7COJS",
        "4182952581": "C4_RIZAKYI_BNGX_VIP_XFYSONKG",
        "4182952573": "C4_RIZAKYI_BNGX_VIP_M4TKBTX8",
        "4182952585": "C4_RIZAKYI_BNGX_VIP_BEISFBUA",
        "4182952574": "C4_RIZAKYI_BNGX_VIP_0DUIA7L9",
        "4182952575": "C4_RIZAKYI_BNGX_VIP_M3INXA0M",
        "4182952583": "C4_RIZAKYI_BNGX_VIP_CK2TSOCJ",
        "4182952570": "C4_RIZAKYI_BNGX_VIP_EWCG9AEK",
        "4182952571": "C4_RIZAKYI_BNGX_VIP_M1BY4L94",
        "4182952578": "C4_RIZAKYI_BNGX_VIP_PYAMXFE6",
        "4182952577": "C4_RIZAKYI_BNGX_VIP_2UJQ4KIB",
        "4182952572": "C4_RIZAKYI_BNGX_VIP_IBSPRO23",
        "4182952587": "C4_RIZAKYI_BNGX_VIP_XZUNJ1BK",
        "4182952576": "C4_RIZAKYI_BNGX_VIP_PWDGDXDJ",
        "4182952579": "C4_RIZAKYI_BNGX_VIP_NVUYQGRX",
        "4182952569": "C4_RIZAKYI_BNGX_VIP_XXN5ACJL",
        "4182952586": "C4_RIZAKYI_BNGX_VIP_VXRKAMCN",
        "4182952582": "C4_RIZAKYI_BNGX_VIP_YKJNRTUT",
        "4182953463": "C4_RIZAKYI_BNGX_VIP_ZPWUUAOU",
        "4182953464": "C4_RIZAKYI_BNGX_VIP_BRETF0VM",
        "4182953466": "C4_RIZAKYI_BNGX_VIP_UEOFNXHM",
        "4182953462": "C4_RIZAKYI_BNGX_VIP_WHD3KUDU",
        "4182953473": "C4_RIZAKYI_BNGX_VIP_8GXLICJH",
        "4182953469": "C4_RIZAKYI_BNGX_VIP_GHB7CNH7",
        "4182953472": "C4_RIZAKYI_BNGX_VIP_BWOVTMTU",
        "4182953480": "C4_RIZAKYI_BNGX_VIP_RTCJUUPQ",
        "4182953476": "C4_RIZAKYI_BNGX_VIP_I24HQ6FR",
        "4182953461": "C4_RIZAKYI_BNGX_VIP_8KKZTADA",
        "4182953465": "C4_RIZAKYI_BNGX_VIP_6QKY9ANE",
        "4182953479": "C4_RIZAKYI_BNGX_VIP_UHDIRFSR",
        "4182953467": "C4_RIZAKYI_BNGX_VIP_OSEXBMOZ",
        "4182953471": "C4_RIZAKYI_BNGX_VIP_FTUOSEIU",
        "4182953477": "C4_RIZAKYI_BNGX_VIP_YITGSBMX",
        "4182953474": "C4_RIZAKYI_BNGX_VIP_LU9IYUG2",
        "4182953478": "C4_RIZAKYI_BNGX_VIP_9RQDDJTM",
        "4182953468": "C4_RIZAKYI_BNGX_VIP_9SKSRJKX",
        "4182953475": "C4_RIZAKYI_BNGX_VIP_XI4KLXPD",
        "4182953939": "C4_RIZAKYI_BNGX_VIP_G4BHPE0J",
        "4182955841": "C4_RIZAKYI_BNGX_VIP_PAH67OZI",
        "4182955843": "C4_RIZAKYI_BNGX_VIP_SHOPGHLX",
        "4182955849": "C4_RIZAKYI_BNGX_VIP_Y0FWTWUZ",
        "4182955851": "C4_RIZAKYI_BNGX_VIP_LNH7GT8K",
        "4182955854": "C4_RIZAKYI_BNGX_VIP_XVZ5QVIS",
        "4182955847": "C4_RIZAKYI_BNGX_VIP_FV6O3JNE",
        "4182955840": "C4_RIZAKYI_BNGX_VIP_GGU5IA9G",
        "4182955848": "C4_RIZAKYI_BNGX_VIP_CXVVLRSX",
        "4182955853": "C4_RIZAKYI_BNGX_VIP_DHL8CZDI",
        "4182955846": "C4_RIZAKYI_BNGX_VIP_4JY2CZT1",
        "4182955856": "C4_RIZAKYI_BNGX_VIP_CK6QN5O4",
        "4182955852": "C4_RIZAKYI_BNGX_VIP_4VFNKTWK",
        "4182955855": "C4_RIZAKYI_BNGX_VIP_QU8JIDD4",
        "4182955842": "C4_RIZAKYI_BNGX_VIP_1C5BEP2V",
        "4182955844": "C4_RIZAKYI_BNGX_VIP_L0OWA4JL",
        "4182955850": "C4_RIZAKYI_BNGX_VIP_XFDJ3NQA",
        "4182955845": "C4_RIZAKYI_BNGX_VIP_VMHZV5ET",
        "4182956763": "C4_RIZAKYI_BNGX_VIP_VBTCAVGW",
        "4182956777": "C4_RIZAKYI_BNGX_VIP_Y7N0GTSY",
        "4182956771": "C4_RIZAKYI_BNGX_VIP_1WXHEAFL",
        "4182956765": "C4_RIZAKYI_BNGX_VIP_SSX0UYI7",
        "4182956778": "C4_RIZAKYI_BNGX_VIP_VI7OZI3J",
        "4182956782": "C4_RIZAKYI_BNGX_VIP_YECSA5GS",
        "4182956768": "C4_RIZAKYI_BNGX_VIP_IRFBUB80",
        "4182956767": "C4_RIZAKYI_BNGX_VIP_F5LWQ3OW",
        "4182956772": "C4_RIZAKYI_BNGX_VIP_FWQNUVKD",
        "4182956779": "C4_RIZAKYI_BNGX_VIP_PTFOVDBY",
        "4182956776": "C4_RIZAKYI_BNGX_VIP_IDFKMZYW",
        "4182956774": "C4_RIZAKYI_BNGX_VIP_1SKLECJD",
        "4182956775": "C4_RIZAKYI_BNGX_VIP_UR627LEQ",
        "4182956773": "C4_RIZAKYI_BNGX_VIP_L3TWOHJO",
        "4182956770": "C4_RIZAKYI_BNGX_VIP_TYN4ZDU4",
        "4182956781": "C4_RIZAKYI_BNGX_VIP_NMPKZIZP",
        "4182956764": "C4_RIZAKYI_BNGX_VIP_WQNRIHMD",
        "4182956769": "C4_RIZAKYI_BNGX_VIP_0LFQJEWU",
        "4182956780": "C4_RIZAKYI_BNGX_VIP_NWBQAHIR",
        "4182956766": "C4_RIZAKYI_BNGX_VIP_FP2NHADP",
        "4182958260": "C4_RIZAKYI_BNGX_VIP_3JQ7SZS9",
        "4182958259": "C4_RIZAKYI_BNGX_VIP_IMYMPXVG",
        "4182958258": "C4_RIZAKYI_BNGX_VIP_MAVP646Z",
        "4182958255": "C4_RIZAKYI_BNGX_VIP_M3CUGDYR"
    },
    {
        "4182958257": "C4_RIZAKYI_BNGX_VIP_32DSVMBZ",
        "4182958253": "C4_RIZAKYI_BNGX_VIP_MFORR9C4",
        "4182958270": "C4_RIZAKYI_BNGX_VIP_MQGEHRX2",
        "4182958251": "C4_RIZAKYI_BNGX_VIP_GB39WQLF",
        "4182958263": "C4_RIZAKYI_BNGX_VIP_JHG0HMZC",
        "4182958268": "C4_RIZAKYI_BNGX_VIP_62G9RLIX",
        "4182958265": "C4_RIZAKYI_BNGX_VIP_TOID76OQ",
        "4182958267": "C4_RIZAKYI_BNGX_VIP_MCUMWOUC",
        "4182958264": "C4_RIZAKYI_BNGX_VIP_IQY1JGAO",
        "4182958275": "C4_RIZAKYI_BNGX_VIP_31EZUDBG",
        "4182958254": "C4_RIZAKYI_BNGX_VIP_WZVBBQGN",
        "4182958272": "C4_RIZAKYI_BNGX_VIP_78ME9MCP",
        "4182958269": "C4_RIZAKYI_BNGX_VIP_RBNHK1FA",
        "4182958252": "C4_RIZAKYI_BNGX_VIP_AVTO80UV",
        "4182958256": "C4_RIZAKYI_BNGX_VIP_RTZJHDHK",
        "4182958266": "C4_RIZAKYI_BNGX_VIP_PB1ZKYJW",
        "4182959607": "C4_RIZAKYI_BNGX_VIP_JJ9XDPDZ",
        "4182959602": "C4_RIZAKYI_BNGX_VIP_TXVIO0FK",
        "4182959603": "C4_RIZAKYI_BNGX_VIP_QQVRPFMD",
        "4182959606": "C4_RIZAKYI_BNGX_VIP_7P1QH2XR",
        "4182959615": "C4_RIZAKYI_BNGX_VIP_BFL2LVVC",
        "4182959612": "C4_RIZAKYI_BNGX_VIP_4SHNNY9K",
        "4182959613": "C4_RIZAKYI_BNGX_VIP_7VI87K0I",
        "4182959605": "C4_RIZAKYI_BNGX_VIP_CQ1D5ARL",
        "4182959614": "C4_RIZAKYI_BNGX_VIP_CMTZTSJG",
        "4182959618": "C4_RIZAKYI_BNGX_VIP_DHB5E6DL",
        "4182959616": "C4_RIZAKYI_BNGX_VIP_GRZPLLTD",
        "4182959621": "C4_RIZAKYI_BNGX_VIP_ZXJ8Y52K",
        "4182959611": "C4_RIZAKYI_BNGX_VIP_GXQHHGDC",
        "4182959619": "C4_RIZAKYI_BNGX_VIP_92HRJHWN",
        "4182959610": "C4_RIZAKYI_BNGX_VIP_ZYS0R4KD",
        "4182959617": "C4_RIZAKYI_BNGX_VIP_BCE7EN9R",
        "4182959624": "C4_RIZAKYI_BNGX_VIP_IAGNBNW1",
        "4182959620": "C4_RIZAKYI_BNGX_VIP_JN11DDAW",
        "4182959622": "C4_RIZAKYI_BNGX_VIP_W8FQB3ZX",
        "4182959608": "C4_RIZAKYI_BNGX_VIP_A6PKI8MW",
        "4182963094": "C4_RIZAKYI_BNGX_VIP_HL0RYTKL",
        "4182963106": "C4_RIZAKYI_BNGX_VIP_SKCVI36R",
        "4182963095": "C4_RIZAKYI_BNGX_VIP_GNEAC1EH",
        "4182963104": "C4_RIZAKYI_BNGX_VIP_7JHDDO1L",
        "4182963097": "C4_RIZAKYI_BNGX_VIP_WDG0OV46",
        "4182963107": "C4_RIZAKYI_BNGX_VIP_Z8CN1FLR",
        "4182963099": "C4_RIZAKYI_BNGX_VIP_FTTEGTXZ",
        "4182963105": "C4_RIZAKYI_BNGX_VIP_QXM2WXQ1",
        "4182963110": "C4_RIZAKYI_BNGX_VIP_S6A3QWKM",
        "4182963114": "C4_RIZAKYI_BNGX_VIP_4CDTCYGN",
        "4182963109": "C4_RIZAKYI_BNGX_VIP_5AABOQDZ",
        "4182963113": "C4_RIZAKYI_BNGX_VIP_YBESXBAM",
        "4182963112": "C4_RIZAKYI_BNGX_VIP_DTFJHBSJ",
        "4182963108": "C4_RIZAKYI_BNGX_VIP_VZPZUMGN",
        "4182963103": "C4_RIZAKYI_BNGX_VIP_U7HG5HQR",
        "4182963096": "C4_RIZAKYI_BNGX_VIP_HR1RKA9V",
        "4182963100": "C4_RIZAKYI_BNGX_VIP_QZC7YE1T",
        "4182963102": "C4_RIZAKYI_BNGX_VIP_1QXEZNL7",
        "4182963101": "C4_RIZAKYI_BNGX_VIP_MWVH5T87",
        "4182963111": "C4_RIZAKYI_BNGX_VIP_O5LGXKLR",
        "4182964320": "C4_RIZAKYI_BNGX_VIP_AQZLOV3V",
        "4182964325": "C4_RIZAKYI_BNGX_VIP_0E7WILO0",
        "4182964322": "C4_RIZAKYI_BNGX_VIP_LYQ2L81Y",
        "4182964326": "C4_RIZAKYI_BNGX_VIP_KUWYGHCL",
        "4182964323": "C4_RIZAKYI_BNGX_VIP_VRNZRWIQ",
        "4182964321": "C4_RIZAKYI_BNGX_VIP_EDDEEDFL",
        "4182964328": "C4_RIZAKYI_BNGX_VIP_BMVWAPBN",
        "4182964337": "C4_RIZAKYI_BNGX_VIP_UEA0KXRR",
        "4182964338": "C4_RIZAKYI_BNGX_VIP_IKMCX0XP",
        "4182964332": "C4_RIZAKYI_BNGX_VIP_MR5KS8SI",
        "4182964335": "C4_RIZAKYI_BNGX_VIP_2LQK8IDY",
        "4182964336": "C4_RIZAKYI_BNGX_VIP_0KTB4Q8X",
        "4182964329": "C4_RIZAKYI_BNGX_VIP_19BGUNY2",
        "4182964333": "C4_RIZAKYI_BNGX_VIP_TGMFJICO",
        "4182964331": "C4_RIZAKYI_BNGX_VIP_MBYENW2B",
        "4182964340": "C4_RIZAKYI_BNGX_VIP_BQ1OWV1W",
        "4182964334": "C4_RIZAKYI_BNGX_VIP_ZVAHX66D",
        "4182964327": "C4_RIZAKYI_BNGX_VIP_UITWT5EA",
        "4182964330": "C4_RIZAKYI_BNGX_VIP_KGD2IGOC",
        "4182964324": "C4_RIZAKYI_BNGX_VIP_EGXMWJ2P",
        "4182965657": "C4_RIZAKYI_BNGX_VIP_AXB2TS1Q",
        "4182965667": "C4_RIZAKYI_BNGX_VIP_QTBX728S",
        "4182965666": "C4_RIZAKYI_BNGX_VIP_NESXE58N",
        "4182965662": "C4_RIZAKYI_BNGX_VIP_B9SPKIGY",
        "4182965671": "C4_RIZAKYI_BNGX_VIP_7GXO9BKF",
        "4182965665": "C4_RIZAKYI_BNGX_VIP_HKVJJOTW",
        "4182965670": "C4_RIZAKYI_BNGX_VIP_E0MUCVPY",
        "4182965675": "C4_RIZAKYI_BNGX_VIP_6KO3GKBB",
        "4182965661": "C4_RIZAKYI_BNGX_VIP_8LCCT0U1",
        "4182965660": "C4_RIZAKYI_BNGX_VIP_HLNFB6GS",
        "4182965658": "C4_RIZAKYI_BNGX_VIP_BF27EZOI",
        "4182965663": "C4_RIZAKYI_BNGX_VIP_ISQSR5X7",
        "4182965676": "C4_RIZAKYI_BNGX_VIP_ORAOH5FE",
        "4182965659": "C4_RIZAKYI_BNGX_VIP_LCARCAGS",
        "4182965669": "C4_RIZAKYI_BNGX_VIP_KBFNYDT2",
        "4182965664": "C4_RIZAKYI_BNGX_VIP_GBUYAVOE",
        "4182965668": "C4_RIZAKYI_BNGX_VIP_3ZXPA7XO",
        "4182965672": "C4_RIZAKYI_BNGX_VIP_NFDPLGWZ",
        "4182965674": "C4_RIZAKYI_BNGX_VIP_PKSHVESF",
        "4182965677": "C4_RIZAKYI_BNGX_VIP_TWH598CQ",
        "4182966334": "C4_RIZAKYI_BNGX_VIP_JTLNKCAP",
        "4182966335": "C4_RIZAKYI_BNGX_VIP_0H47PE8A",
        "4182966351": "C4_RIZAKYI_BNGX_VIP_NAX7BES8",
        "4182966338": "C4_RIZAKYI_BNGX_VIP_Q2EUNLMV"
    },
    {
        "4182966337": "C4_RIZAKYI_BNGX_VIP_29ADNNHB",
        "4182966353": "C4_RIZAKYI_BNGX_VIP_S8GBRWB7",
        "4182966347": "C4_RIZAKYI_BNGX_VIP_RWCNEBXS",
        "4182966336": "C4_RIZAKYI_BNGX_VIP_BCDBY6S6",
        "4182966349": "C4_RIZAKYI_BNGX_VIP_DVAF2Z5K",
        "4182966343": "C4_RIZAKYI_BNGX_VIP_QQZ8BHCI",
        "4182966342": "C4_RIZAKYI_BNGX_VIP_N7MWGSAE",
        "4182966345": "C4_RIZAKYI_BNGX_VIP_RC3PSA5R",
        "4182966344": "C4_RIZAKYI_BNGX_VIP_PIIH4MII",
        "4182966346": "C4_RIZAKYI_BNGX_VIP_W9MFFZUX",
        "4182966350": "C4_RIZAKYI_BNGX_VIP_RZ3OUMBD",
        "4182966339": "C4_RIZAKYI_BNGX_VIP_PZ0AS5BS",
        "4182966348": "C4_RIZAKYI_BNGX_VIP_3F2KY9IV",
        "4182966352": "C4_RIZAKYI_BNGX_VIP_7SUMLW1H",
        "4182966341": "C4_RIZAKYI_BNGX_VIP_TEHN6NU6",
        "4182967347": "C4_RIZAKYI_BNGX_VIP_0NSRH22I",
        "4182967350": "C4_RIZAKYI_BNGX_VIP_ABA2NBSK",
        "4182967356": "C4_RIZAKYI_BNGX_VIP_PZIUHQBP",
        "4182967364": "C4_RIZAKYI_BNGX_VIP_IAFYJ3BS",
        "4182967358": "C4_RIZAKYI_BNGX_VIP_XN5UZAWV",
        "4182967366": "C4_RIZAKYI_BNGX_VIP_229QMEW0",
        "4182967369": "C4_RIZAKYI_BNGX_VIP_57WOWMMP",
        "4182967367": "C4_RIZAKYI_BNGX_VIP_EDZ6AEHW",
        "4182967357": "C4_RIZAKYI_BNGX_VIP_3HEGTKBG",
        "4182967348": "C4_RIZAKYI_BNGX_VIP_UZDPTJYS",
        "4182967360": "C4_RIZAKYI_BNGX_VIP_308IIKHA",
        "4182967368": "C4_RIZAKYI_BNGX_VIP_FNYAFVSX",
        "4182967355": "C4_RIZAKYI_BNGX_VIP_FCU4EDPV",
        "4182967349": "C4_RIZAKYI_BNGX_VIP_CPTQCPRU",
        "4182967351": "C4_RIZAKYI_BNGX_VIP_YRBNRU3Q",
        "4182967352": "C4_RIZAKYI_BNGX_VIP_KS0NYAMA",
        "4182967353": "C4_RIZAKYI_BNGX_VIP_MUEZAOX0",
        "4182967359": "C4_RIZAKYI_BNGX_VIP_R5PDWPCO",
        "4182967365": "C4_RIZAKYI_BNGX_VIP_HOGT6Z0L",
        "4182967362": "C4_RIZAKYI_BNGX_VIP_PWTQVJNW",
        "4182972648": "C4_RIZAKYI_BNGX_VIP_VUJWJQMA",
        "4182972645": "C4_RIZAKYI_BNGX_VIP_4VWGGMN1",
        "4182972637": "C4_RIZAKYI_BNGX_VIP_AVGYNGEV",
        "4182972643": "C4_RIZAKYI_BNGX_VIP_YJVXLKJZ",
        "4182972651": "C4_RIZAKYI_BNGX_VIP_5G3TP464",
        "4182972639": "C4_RIZAKYI_BNGX_VIP_JGZGKAAN",
        "4182972647": "C4_RIZAKYI_BNGX_VIP_BZH08REC",
        "4182972649": "C4_RIZAKYI_BNGX_VIP_UXTNKYZE",
        "4182972636": "C4_RIZAKYI_BNGX_VIP_YIDSPKSJ",
        "4182972642": "C4_RIZAKYI_BNGX_VIP_W0XDGUDA",
        "4182972644": "C4_RIZAKYI_BNGX_VIP_CVPHTEJM",
        "4182972634": "C4_RIZAKYI_BNGX_VIP_ZJPDNVEJ",
        "4182972652": "C4_RIZAKYI_BNGX_VIP_I2HDWIFS",
        "4182972641": "C4_RIZAKYI_BNGX_VIP_R3IZBUKJ",
        "4182972638": "C4_RIZAKYI_BNGX_VIP_RHMMQYNS",
        "4182972646": "C4_RIZAKYI_BNGX_VIP_EANB97FJ",
        "4182972632": "C4_RIZAKYI_BNGX_VIP_B1C0TMCC",
        "4182972650": "C4_RIZAKYI_BNGX_VIP_3I8IFGDU",
        "4182972635": "C4_RIZAKYI_BNGX_VIP_T56SZ5B5",
        "4182972633": "C4_RIZAKYI_BNGX_VIP_Y4W1DRTV",
        "4182980440": "C4_RIZAKYI_BNGX_VIP_BCD99WY8",
        "4182980447": "C4_RIZAKYI_BNGX_VIP_5ZBWGRGJ",
        "4182980456": "C4_RIZAKYI_BNGX_VIP_5AQQWKN8",
        "4182980461": "C4_RIZAKYI_BNGX_VIP_G5VHLTXP",
        "4182980444": "C4_RIZAKYI_BNGX_VIP_JHDCRXYT",
        "4182980460": "C4_RIZAKYI_BNGX_VIP_GEDEAPEM",
        "4182980457": "C4_RIZAKYI_BNGX_VIP_0OFM59GN",
        "4182980452": "C4_RIZAKYI_BNGX_VIP_QKCDSJVX",
        "4182980442": "C4_RIZAKYI_BNGX_VIP_Z5MMGKBX",
        "4182980458": "C4_RIZAKYI_BNGX_VIP_GZIHUPYP",
        "4182980459": "C4_RIZAKYI_BNGX_VIP_KOF4XVQH",
        "4182980449": "C4_RIZAKYI_BNGX_VIP_FDOAVXSA",
        "4182980453": "C4_RIZAKYI_BNGX_VIP_OP5ZHD4O",
        "4182980448": "C4_RIZAKYI_BNGX_VIP_C4BTIXFZ",
        "4182980445": "C4_RIZAKYI_BNGX_VIP_HLFKRR9K",
        "4182980462": "C4_RIZAKYI_BNGX_VIP_EL01ET5G",
        "4182980454": "C4_RIZAKYI_BNGX_VIP_QYI7RHGV",
        "4182980455": "C4_RIZAKYI_BNGX_VIP_RLX595OE",
        "4182980446": "C4_RIZAKYI_BNGX_VIP_ZJAD2LKA",
        "4182980443": "C4_RIZAKYI_BNGX_VIP_CMF7LQ4A",
        "4182981929": "C4_RIZAKYI_BNGX_VIP_FYIFIIWM",
        "4182981934": "C4_RIZAKYI_BNGX_VIP_K7YMYNDJ",
        "4182981933": "C4_RIZAKYI_BNGX_VIP_EXFD8PDM",
        "4182981924": "C4_RIZAKYI_BNGX_VIP_WNF91QK0",
        "4182981932": "C4_RIZAKYI_BNGX_VIP_PLYAPIUB",
        "4182981925": "C4_RIZAKYI_BNGX_VIP_X7EU4LWF",
        "4182981930": "C4_RIZAKYI_BNGX_VIP_SKAP7WFO",
        "4182981927": "C4_RIZAKYI_BNGX_VIP_CAK9404I",
        "4182981942": "C4_RIZAKYI_BNGX_VIP_3ILTS5MM",
        "4182981935": "C4_RIZAKYI_BNGX_VIP_6TH772BN",
        "4182981928": "C4_RIZAKYI_BNGX_VIP_J1FVCFWL",
        "4182981940": "C4_RIZAKYI_BNGX_VIP_U2RMCA9I",
        "4182981921": "C4_RIZAKYI_BNGX_VIP_DHS9HRAG",
        "4182981937": "C4_RIZAKYI_BNGX_VIP_MGGCRMDH",
        "4182981922": "C4_RIZAKYI_BNGX_VIP_KLSIQTBB",
        "4182981923": "C4_RIZAKYI_BNGX_VIP_WXPADU4Z",
        "4182981938": "C4_RIZAKYI_BNGX_VIP_AAKSSPYL",
        "4182981936": "C4_RIZAKYI_BNGX_VIP_IECCDL0B",
        "4182981939": "C4_RIZAKYI_BNGX_VIP_0LTWTIJT",
        "4182984364": "C4_RIZAKYI_BNGX_VIP_KQ9FMZ2N",
        "4182984369": "C4_RIZAKYI_BNGX_VIP_CAHIHHCN",
        "4182984358": "C4_RIZAKYI_BNGX_VIP_PFGGYOX7",
        "4182984374": "C4_RIZAKYI_BNGX_VIP_QK8TBAJS",
        "4182984376": "C4_RIZAKYI_BNGX_VIP_YTZTOPAC",
        "4182984365": "C4_RIZAKYI_BNGX_VIP_JLUYRCQ7",
        "4182984375": "C4_RIZAKYI_BNGX_VIP_D8JC8T1A"
    },
  {
        "4197290645": "BNGX_Vip_is_here_QFTH67ABX",
        "4197290667": "BNGX_Vip_is_here_NVJTNTVMA",
        "4197290680": "BNGX_Vip_is_here_IJ7RR6JJF",
        "4197290706": "BNGX_Vip_is_here_N80HHLP0H",
        "4197290676": "BNGX_Vip_is_here_HX9AFW6Y2",
        "4197290707": "BNGX_Vip_is_here_T6KYN3UJA",
        "4197290685": "BNGX_Vip_is_here_2UQL0TF6T",
        "4197290734": "BNGX_Vip_is_here_6U6P65F3Q",
        "4197290699": "BNGX_Vip_is_here_YA8BXXYB8",
        "4197290639": "BNGX_Vip_is_here_4E8OXW28Q",
        "4197290712": "BNGX_Vip_is_here_AA7HZSH3W",
        "4197290673": "BNGX_Vip_is_here_6DB1Y85PB",
        "4197290710": "BNGX_Vip_is_here_QL3NGRXLD",
        "4197290638": "BNGX_Vip_is_here_ORCM0AEDW",
        "4197290635": "BNGX_Vip_is_here_8ZM0VK8EU",
        "4197290636": "BNGX_Vip_is_here_5KVMP00KW",
        "4197290662": "BNGX_Vip_is_here_EE0VMH4J0",
        "4197290793": "BNGX_Vip_is_here_O1FN024RU",
        "4197290718": "BNGX_Vip_is_here_BLP7RYIVH",
        "4197290670": "BNGX_Vip_is_here_D7303CLJL",
        "4197290701": "BNGX_Vip_is_here_520WF3A48",
        "4197290621": "BNGX_Vip_is_here_OSYT3VW34",
        "4197290664": "BNGX_Vip_is_here_BDYSUGRTD",
        "4197290646": "BNGX_Vip_is_here_Z19S80MJ6",
        "4197290702": "BNGX_Vip_is_here_Z1NWWPKR8",
        "4197290669": "BNGX_Vip_is_here_IVZRG43UK",
        "4197290649": "BNGX_Vip_is_here_TNO4251UH",
        "4197290711": "BNGX_Vip_is_here_IJERFIF8O",
        "4197290716": "BNGX_Vip_is_here_HPM91WHAG",
        "4197290684": "BNGX_Vip_is_here_S7G1WB1B3",
        "4197290708": "BNGX_Vip_is_here_B991D8VFL",
        "4197290678": "BNGX_Vip_is_here_JVUZWSY99",
        "4197290812": "BNGX_Vip_is_here_75GD760M0",
        "4197290659": "BNGX_Vip_is_here_3J3V31YXJ",
        "4197290658": "BNGX_Vip_is_here_KXJCMXT67",
        "4197290627": "BNGX_Vip_is_here_YBVRMILKW",
        "4197290657": "BNGX_Vip_is_here_49C6PUDHR",
        "4197290660": "BNGX_Vip_is_here_RV77YOH9L",
        "4197290644": "BNGX_Vip_is_here_65MNRSRCB",
        "4197290831": "BNGX_Vip_is_here_JNZOS5KPM",
        "4197290817": "BNGX_Vip_is_here_6GFIXWU6J",
        "4197290835": "BNGX_Vip_is_here_13WSGN5Y6",
        "4197290688": "BNGX_Vip_is_here_J2ITNAVNJ",
        "4197290728": "BNGX_Vip_is_here_5D9QULEEP",
        "4197290811": "BNGX_Vip_is_here_UPWK914I7",
        "4197290682": "BNGX_Vip_is_here_Y8MIRNCUF",
        "4197290671": "BNGX_Vip_is_here_2L8XMNK0T",
        "4197290647": "BNGX_Vip_is_here_YR3V9QWY4",
        "4197290805": "BNGX_Vip_is_here_CARNUKTWM",
        "4197290762": "BNGX_Vip_is_here_44AZI0P1O",
        "4197290845": "BNGX_Vip_is_here_NEYPEEVPF",
        "4197290889": "BNGX_Vip_is_here_3276GOBPT",
        "4197290875": "BNGX_Vip_is_here_8YBC85QDD",
        "4197290910": "BNGX_Vip_is_here_JGKZVZIFN",
        "4197290929": "BNGX_Vip_is_here_YCXHMTYZY",
        "4197290926": "BNGX_Vip_is_here_8DTJBF8TC",
        "4197290824": "BNGX_Vip_is_here_0A5QYM2QG",
        "4197290855": "BNGX_Vip_is_here_060TMW74V",
        "4197290886": "BNGX_Vip_is_here_W3JDPWIIJ",
        "4197290906": "BNGX_Vip_is_here_AMFAY135Y",
        "4197290850": "BNGX_Vip_is_here_8W5JG4ZB3",
        "4197291010": "BNGX_Vip_is_here_WR2Z1M9WO",
        "4197290849": "BNGX_Vip_is_here_7ISEDR8CD",
        "4197290827": "BNGX_Vip_is_here_M5WGY1IZB",
        "4197291011": "BNGX_Vip_is_here_6UDJ50TE4",
        "4197290866": "BNGX_Vip_is_here_RRV7EVB53",
        "4197291021": "BNGX_Vip_is_here_VJ5UU8PS4",
        "4197290863": "BNGX_Vip_is_here_ZFCP7Z3BQ",
        "4197291026": "BNGX_Vip_is_here_XXGOKADN5",
        "4197291034": "BNGX_Vip_is_here_CTQS660WQ",
        "4197291027": "BNGX_Vip_is_here_5MVP1HEE4",
        "4197290896": "BNGX_Vip_is_here_Q1F2NIELJ",
        "4197290904": "BNGX_Vip_is_here_5UKBN86BD",
        "4197290890": "BNGX_Vip_is_here_S4PTCJUDV",
        "4197290858": "BNGX_Vip_is_here_YU897XS5S",
        "4197291045": "BNGX_Vip_is_here_WZ24DORDD",
        "4197290895": "BNGX_Vip_is_here_5AY4I2EM8",
        "4197290917": "BNGX_Vip_is_here_H5HD5S4PR",
        "4197291047": "BNGX_Vip_is_here_BAQOZNMR8",
        "4197290957": "BNGX_Vip_is_here_KXD6FCCHP",
        "4197290953": "BNGX_Vip_is_here_RX94JV4LS",
        "4197291024": "BNGX_Vip_is_here_7IABWKFN5",
        "4197290932": "BNGX_Vip_is_here_RSEGBIOM0",
        "4197291037": "BNGX_Vip_is_here_A6AJQT2B1",
        "4197291082": "BNGX_Vip_is_here_8HLB1QMJH",
        "4197291008": "BNGX_Vip_is_here_NK7ZTDRA6",
        "4197291086": "BNGX_Vip_is_here_5M10OEMTH",
        "4197291072": "BNGX_Vip_is_here_IYV04E67V",
        "4197290934": "BNGX_Vip_is_here_ZF3VTALVS",
        "4197291022": "BNGX_Vip_is_here_8P1TE2D90",
        "4197291074": "BNGX_Vip_is_here_241F37J5V",
        "4197290902": "BNGX_Vip_is_here_KBVL2U9X1",
        "4197291059": "BNGX_Vip_is_here_GA6MF6QXW",
        "4197290955": "BNGX_Vip_is_here_J3GB8O7NR",
        "4197291067": "BNGX_Vip_is_here_6LDZV9RRJ",
        "4197291081": "BNGX_Vip_is_here_9S82QLPAF",
        "4197291030": "BNGX_Vip_is_here_GXUQ6W9WO",
        "4197290944": "BNGX_Vip_is_here_GUD68HJTA",
        "4197290965": "BNGX_Vip_is_here_76N43EI0Z",
        "4197291115": "BNGX_Vip_is_here_K9HOKZZ6N"
    }
]
JWT_API_TEMPLATE = "https://jwt-lac.vercel.app/api/oauth_guest?uid={uid}&password={password}"

CACHE = {
    "tokens": {},   # dict {uid: token}
    "timestamp": 0
}

COLLECTED_TOKENS = {}
GROUP_INDEX = 0  # مؤشر المجموعة الحالية

CACHE_DURATION = 10000  # ثانية
CONCURRENT_LIMIT = 500  # عدد الاتصالات المتزامنة

async def fetch_token(session, uid, password):
    url = JWT_API_TEMPLATE.format(uid=uid, password=password)
    try:
        async with session.get(url) as resp:
            if resp.status == 200:
                data = await resp.json()
                token = data.get("token")
                if token:
                    return uid, token
            return uid, None
    except Exception as e:
        print(f"Error fetching token for uid {uid}: {e}")
        return uid, None

async def fetch_token_with_semaphore(semaphore, session, uid, password):
    async with semaphore:
        return await fetch_token(session, uid, password)

async def fetch_tokens_for_group(group):
    tokens = {}
    semaphore = asyncio.Semaphore(CONCURRENT_LIMIT)
    async with aiohttp.ClientSession() as session:
        tasks = [fetch_token_with_semaphore(semaphore, session, uid, password)
                 for uid, password in group.items()]
        results = await asyncio.gather(*tasks)
        for uid, token in results:
            if token:
                tokens[uid] = token
    return tokens

def is_cache_valid():
    return (time.time() - CACHE["timestamp"]) < CACHE_DURATION and len(CACHE["tokens"]) > 0

def get_last_update_vn():
    utc_time = datetime.fromtimestamp(CACHE["timestamp"], tz=timezone.utc)
    vn_time = utc_time + timedelta(hours=7)
    return vn_time.strftime("%Y-%m-%d %H:%M:%S")

@app.route("/api/get_jwt", methods=["GET"])
def get_jwt_tokens():
    global GROUP_INDEX, COLLECTED_TOKENS

    if is_cache_valid():
        return jsonify({
            "count": len(CACHE["tokens"]),
            "last_update_vn": get_last_update_vn(),
            "tokens": CACHE["tokens"]
        })

    async def process_groups():
        global GROUP_INDEX
        groups_to_fetch = []

        # جلب الجروب الحالي
        groups_to_fetch.append(group_accounts[GROUP_INDEX])

        # جلب الجروب اللي بعده
        next_index = (GROUP_INDEX + 1) % len(group_accounts)
        if next_index != GROUP_INDEX:
            groups_to_fetch.append(group_accounts[next_index])

        all_tokens = {}
        for group in groups_to_fetch:
            tokens = await fetch_tokens_for_group(group)
            all_tokens.update(tokens)

        # تحديث المؤشر (+2 كل مرة)
        GROUP_INDEX = (GROUP_INDEX + 2) % len(group_accounts)

        return all_tokens

    new_tokens = asyncio.run(process_groups())
    COLLECTED_TOKENS.update(new_tokens)

    if GROUP_INDEX == 0:  # يعني خلصنا دورة كاملة
        CACHE["tokens"] = COLLECTED_TOKENS.copy()
        CACHE["timestamp"] = time.time()
        COLLECTED_TOKENS.clear()

    return jsonify({
        "count": len(COLLECTED_TOKENS) if not CACHE["tokens"] else len(CACHE["tokens"]),
        "last_update_vn": get_last_update_vn() if CACHE["tokens"] else None,
        "tokens": CACHE["tokens"] if CACHE["tokens"] else COLLECTED_TOKENS
    })
if __name__ == "__main__":
    port = int(os.environ.get("PORT", 10000))
    app.run(host="0.0.0.0", port=port)
